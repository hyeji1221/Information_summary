# Setting up your ML application

- 데이터를 설정하기 위한 하이퍼파라미터 튜닝
- 최적화 알고리즘의 속도를 높여 적당한 시간 안에 학습 알고리즘이 학습할 수 있도록 하는 방법
- 머신러닝 문제를 어떻게 해결하는지  알아보기 & 정규화에 대해 다루고 신경망 구현이 맞게 되었는지 확인하는 기술 알아보기

## Train/dev/test sets

- 훈련, 개발 테스트 세트를 어떻게 설정할지에 대해 좋은 선택을 내리는 것은 좋은 성능을 내는 네트워크를 빠르게 찾는데 큰 영향을 줌

### 신경망을 훈련시킬 때 내리는 많은 결정

- 신경망이 몇개의 층을 가지는지
- 각각의 층에 사용되는 은닉 유닛의 개수
- 학습률
- 서로 다른 층에 사용하는 활성화 함수

처음 시작할 때는 이 모든 것에 대해 올바른 값을 추측하는 것이 거의 불가능 -> 다른 하이퍼파라미터에 대해서도 마찬가지

따라서 실질적으로 머신러닝을 적용하는 것은 매우 반복적인 과정

주로 처음에는 아이디어로 시작 -> 실험 진행 -> 결과에 기반해 아이디어를 개선하고 몇가지 선택 바꾸기 (이 과정을 반복)

훈련, 개발, 테스트 세트를 잘 설정하는 것은 과정을더 효율적으로 만든다

#### 작업의 흐름

1. 훈련 세트에 대해 계속 훈련 알고리즘을 적용시키면서 개발세트에 대해 다양한 모델 중 어떤 모델이 가장 좋은 성능을 내는지 확인
2. 이 과정을 충분히 거치고 더 발전시키고 싶은 최종 모델이 나오면 테스트 세트에 그 모델을 적용시켜 알고리즘이 얼마나 잘 작동하는지 편향 없이 측정

#### 데이터 세트 나누기

데이터 세트를 나누는 비중이 보통은 60/20/20%

그러나 총 100만 개 이상의 샘플이 있는 현재 빅데이터 시대에는 **개발 세트와 테스트 세트가 훨씬 더 작은 비율**이 되는 것이 트렌드 -> 개발 세트는 평가할 수 있을 정도로만 크면 되기 때문 & 테스트 세트 또한 주요 목표는 최종 분류기가 어느 정도 성능인지 신뢰있는 추정치를 제공하는 것이므로 백만 개의 샘플이 있다면 만 개의 샘플을 설정해도 충분

-> 백 만개의 데이터가 있는 경우 98/1/1%

### Mismatched train/test distribution

현재 딥러닝의 또 다른 트렌드 : 더 많은 사람들이 일치하지 않는 훈련/테스트 분포에서 훈련시킨다는 것

#### 사용자 업로드한 사진 중 고양이 사진을 찾아 보여주기

- training set : 인터넷에서 다운 받은 고양이 사진 -> 전문가스럽고 잘 정돈된 고양이 사진 
- dev/test set : 사용자들에 의해 구성된 것 -> 흐릿한 저해상도의 사진

=> 이 두 가지 데이터의 분포는 달라질 수 있음 -> 이러한 경우 개발과 테스트세트가 같은 분포에서 와야 함

테스트 세트를 갖지 않아도 괜찮다 (Only dev set.) -> 테스트 세트의 목표는 최종 네트워크의 성능에 대한 비편향 추정을 제공 -> 이러한 비편향 추정이 필요없는 경우 테스트 세트가 없어도 됨

머신러닝에서 별도의 테스트 세트 없이 훈련 세트와 개발 세트만 있는 경우 대부분 **개발 세트를 테스트 세트**라고 부른다

훈련, 개발 테스트 세트 설정 -> 반복을 더 빠르게 할 수 있도록 함 & 알고리즘의 편향과 분산을 효율적으로 측정할 수 있도록 함

## Bias/Variance

높은 편향값의 클래스 -> 데이터의 과소적합

높은 분산의 클래스 -> 데이터의 과대 적합

편향과 분산을 이해하기 위해 중요한 두가지 숫자 : 훈련 세트 오차, 개발 세트 오차

## Basic Recipe for Machine Learning

최초의 모델 훈련 후 알고리즘이 높은 편향을 가지는지, 높은 분산을 가지는지 평가 하기 위해서는 훈련 데이터의 성능을 봐야함

#### 과소적합인 경우

- 더 많은 은닉층 혹은 은닉 유닛을 갖는 네트워크 선택
- 더 오래 훈련 시키기
- 다른 발전된 최적화 알고리즘 사용
- (문제에 더 잘맞는 신경망 아키텍처 찾기) -> 잘 작동되게 할 수도 그렇지 않을 수도 있음

-> 이렇게 학습 시킨 후 과대 적합인지 확인 -> 개발 세트의 성능 확인

#### 과대 적합인 경우

- 데이터를 더 얻기
- 정규화 시도
- (다른 신경망 아키텍처 찾기)

위의 2가지 경우에서 **네트워크 증가**와 **데이터를 더 얻는 방법**은 편향만을 감소시키거나 분산만을 감소시키는 툴